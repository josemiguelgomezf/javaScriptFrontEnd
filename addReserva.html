<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="./spinner.css" />
    <link rel="stylesheet" href="./notification.css" />
    <link rel="stylesheet" href="./addReserva.css" />
    <link rel="stylesheet" href="./global.css" />
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <title>Javapop - Add reserva</title>
</head>
<body>
    <div class="header">
        <img class="logotipo" src="./images/Javapop.png">
        <h1>Javapop - Add reserva</h1>
        <div class="buttonBackDiv">
            <img class="signup" src="./images/back.png">
            <button onclick="location.href = '/';" id="backAddFilm" class="backButton">BACK</button>
        </div>
    </div>
    <main>
        <section class="add">
            <form action="" id="addForm">
                <div class="notification">
                </div>
                <div id="mensajeAlerta">
                </div>

                <div>
                    <label for="rooms">Choose a room:</label>
                    <select name="rooms" id="rooms">
                    </select>
                </div>

                <div class="salaCine">

                </div>

                <div>
                    <label for="rows">Choose a row:</label>
                    <input type="number" id="rows" name="rows" min="0" >
                </div>
                
                <div>
                    <label for="columns">Choose a column:</label>
                    <input type="number" id="columns" name="columns" min="0">
                </div>

                <div>
                    <label for="films">Choose a film:</label>
                    <select name="films" id="films">
                    </select>
                </div>
                
                <div>
                    <label for="dateInput">Date</label>
                    <input type="date" name="dateInput" id="dateInput" placeholder="date" required />
                </div>

                <div>
                    <label for="hourInput">Hour</label>
                    <input type="time" name="hourInput" id="hourInput" placeholder="hour" required />
                </div>

                <button id="createTicketButton">CREATE TICKET</button>
                <script>document.getElementById("createTicketButton").onclick = function(){
                    var i=Math.random() * (5000 - 755) + 123;
                    const rooms = document.querySelector("#rooms").value;
                    const rows = document.querySelector("#rows").value;
                    const columns = document.querySelector("#columns").value;
                    const film = document.querySelector("#films").value;
                    const date = document.querySelector("#dateInput").value;
                    const hour = document.querySelector("#hourInput").value;
                    var creditCard = "";
                    

                    function download(filename, text) {
                    var element = document.createElement('a');
                    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
                    element.setAttribute('download', filename);
              
                    element.style.display = 'none';
                    document.body.appendChild(element);
              
                    element.click();
              
                    document.body.removeChild(element);
                }
                
                    Swal.fire({
                    title: 'Are you sure?',
                    input: 'text',
                    text: "You won't be able to revert this!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes, pay!'
                  }).then((result) => {
                    if (result.isConfirmed) {
                        const p = document.querySelector(".error");
                        console.log(result.value);
                        if(p || result.value==""){
                            Swal.fire(
                        ''+i,
                        'You must introduce all dates of reserva!',
                        'error'
                      );} else{
                            Swal.fire(
                        ''+i,
                        'You must show that number at the entry!',
                        'success'
                      );
                      // Start file download.
                download(i+".txt",rooms+"/"+rows+"/"+columns+"/"+film+"/"+date+"/"+hour);
                        }
                      
              
                    }
                  });
                    
                
                    };</script>
            </form>
        </section>
    </main>
    <script type="module" src="addReserva.js"></script>
</body>
</html>